from typing import List
from exploits.exploit import Exploit
from analysis.fuzzer.fuzzer import fuzz


class BufferOverflowAttack(Exploit):
    def __init__(self, max_tries):
        super().__init__(max_tries)

        self._name = "buffer overflow"
        self._vulnerable_functions = [
            "gets",
            "fgets",
            "strcopy",
            "strcat",
            "sprintf",
            "gets_s",
            "read",
            "strncpy",
            "strncat",
            "memcpy",
        ]

    @property
    def name(self) -> str:
        return self._name

    @property
    def vulnerable_functions(self) -> List[str]:
        return self._vulnerable_functions

    def exploit(self, process, iteration):
        failed = fuzz(process)
        return failed
